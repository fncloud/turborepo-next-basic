(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[6711],{4141:(e,t,r)=>{Promise.resolve().then(r.bind(r,95164))},95164:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>B});var a=r(54568),s=r(1165),l=r(92247),n=r(34050);async function i(e,t){return(0,n.A)("/v1/public/ticket/",{method:"PUT",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function d(e,t){return(0,n.A)("/v1/public/ticket/",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function o(e,t){return(0,n.A)("/v1/public/ticket/detail",{method:"GET",params:{...e},...t||{}})}async function c(e,t){return(0,n.A)("/v1/public/ticket/follow",{method:"POST",headers:{"Content-Type":"application/json"},data:e,...t||{}})}async function u(e,t){return(0,n.A)("/v1/public/ticket/list",{method:"GET",params:{...e},...t||{}})}var m=r(12468),f=r(26525),p=r(46359),x=r(79045),h=r(7620),g=r(29678),v=r(49773);let b=e=>{let{shouldScaleBackground:t=!0,...r}=e;return(0,a.jsx)(g._s.Root,{shouldScaleBackground:t,...r})};b.displayName="Drawer",g._s.Trigger;let j=g._s.Portal;g._s.Close;let y=h.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(g._s.Overlay,{ref:t,className:(0,v.cn)("fixed inset-0 z-50 bg-black/80",r),...s})});y.displayName=g._s.Overlay.displayName;let N=h.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,a.jsxs)(j,{children:[(0,a.jsx)(y,{}),(0,a.jsxs)(g._s.Content,{ref:t,className:(0,v.cn)("bg-background fixed inset-x-0 bottom-0 z-50 mt-24 flex h-auto flex-col rounded-t-[10px] border",r),...l,children:[(0,a.jsx)("div",{className:"bg-muted mx-auto mt-4 h-2 w-[100px] rounded-full"}),s]})]})});N.displayName="DrawerContent";let w=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,v.cn)("grid gap-1.5 p-4 text-center sm:text-left",t),...r})};w.displayName="DrawerHeader";let k=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,v.cn)("mt-auto flex flex-col gap-2 p-4",t),...r})};k.displayName="DrawerFooter";let C=h.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(g._s.Title,{ref:t,className:(0,v.cn)("text-lg font-semibold leading-none tracking-tight",r),...s})});C.displayName=g._s.Title.displayName;let R=h.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)(g._s.Description,{ref:t,className:(0,v.cn)("text-muted-foreground text-sm",r),...s})});R.displayName=g._s.Description.displayName;var T=r(47019),_=r(24721),D=r(74243);let z=h.forwardRef((e,t)=>{let{className:r,children:s,...l}=e;return(0,a.jsxs)(D.bL,{ref:t,className:(0,v.cn)("relative overflow-hidden",r),...l,children:[(0,a.jsx)(D.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,a.jsx)(E,{}),(0,a.jsx)(D.OK,{})]})});z.displayName=D.bL.displayName;let E=h.forwardRef((e,t)=>{let{className:r,orientation:s="vertical",...l}=e;return(0,a.jsx)(D.VM,{ref:t,orientation:s,className:(0,v.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",r),...l,children:(0,a.jsx)(D.lr,{className:"bg-border relative flex-1 rounded-full"})})});E.displayName=D.VM.displayName;let F=h.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("textarea",{className:(0,v.cn)("border-input placeholder:text-muted-foreground focus-visible:ring-ring flex min-h-[60px] w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-sm focus-visible:outline-none focus-visible:ring-1 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...s})});F.displayName="Textarea";var S=r(61674);let A=e=>{let{trigger:t,title:r,description:s,onConfirm:l,cancelText:n="Cancel",confirmText:i="Confirm"}=e;return(0,a.jsxs)(S.Lt,{children:[(0,a.jsx)(S.tv,{asChild:!0,children:t}),(0,a.jsxs)(S.EO,{children:[(0,a.jsxs)(S.wd,{children:[(0,a.jsx)(S.r7,{children:r}),(0,a.jsx)(S.$v,{children:s})]}),(0,a.jsxs)(S.ck,{children:[(0,a.jsx)(S.Zr,{children:n}),(0,a.jsx)(S.Rx,{onClick:l,children:i})]})]})]})};var L=r(44488),O=r(94453),$=r(69539),I=r(42950),Z=r.n(I),U=r(56547);function B(){var e,t;let r=(0,$.useTranslations)("ticket"),[n,g]=(0,h.useState)(null),[j,y]=(0,h.useState)(""),{data:D,refetch:E}=(0,m.I)({queryKey:["getUserTicketDetails",n],queryFn:async()=>{let{data:e}=await o({id:n});return e.data},enabled:!!n,refetchInterval:5e3}),S=(0,h.useRef)(null);(0,h.useEffect)(()=>{setTimeout(()=>{if(S.current){var e;null===(e=S.current.children[1])||void 0===e||e.scrollTo({top:S.current.children[1].scrollHeight,behavior:"smooth"})}},66)},[null==D?void 0:null===(e=D.follow)||void 0===e?void 0:e.length]);let I=(0,h.useRef)(null),[B,P]=(0,h.useState)();return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(l.o,{action:I,header:{title:r("ticketList"),toolbar:(0,a.jsxs)(x.Dialog,{open:null==B?void 0:B.open,onOpenChange:e=>P({open:e}),children:[(0,a.jsx)(x.zM,{asChild:!0,children:(0,a.jsx)(f.$,{size:"sm",children:r("createTicket")})}),(0,a.jsxs)(x.DialogContent,{className:"sm:max-w-[425px]",children:[(0,a.jsxs)(x.DialogHeader,{children:[(0,a.jsx)(x.DialogTitle,{children:r("createTicket")}),(0,a.jsx)(x.rr,{children:r("createTicketDescription")})]}),(0,a.jsxs)("div",{className:"grid gap-4 py-4",children:[(0,a.jsx)(_.J,{htmlFor:"title",children:r("title")}),(0,a.jsx)(T.p,{id:"title",defaultValue:null==B?void 0:B.title,onChange:e=>P({...B,title:e.target.value})}),(0,a.jsx)(_.J,{htmlFor:"content",children:r("description")}),(0,a.jsx)(F,{id:"content",defaultValue:null==B?void 0:B.description,onChange:e=>P({...B,description:e.target.value})})]}),(0,a.jsx)(x.Es,{children:(0,a.jsx)(f.$,{disabled:!(null==B?void 0:B.title)||!(null==B?void 0:B.description),onClick:async()=>{var e;await d({title:B.title,description:B.description}),null===(e=I.current)||void 0===e||e.refresh(),U.toast.success(r("createSuccess")),P({open:!1})},children:r("submit")})})]})]})},params:[{key:"search"},{key:"status",placeholder:r("status.0"),options:[{label:r("close"),value:"4"}]}],request:async(e,t)=>{var r,a;let{data:s}=await u({...e,...t});return{list:(null===(r=s.data)||void 0===r?void 0:r.list)||[],total:(null===(a=s.data)||void 0===a?void 0:a.total)||0}},renderItem:e=>(0,a.jsxs)(p.Zp,{className:"overflow-hidden",children:[(0,a.jsxs)(p.aR,{className:"bg-muted/50 flex flex-row items-center justify-between gap-2 space-y-0 p-3",children:[(0,a.jsx)(p.ZB,{children:(0,a.jsx)("span",{className:(0,v.cn)("flex items-center gap-2 before:block before:size-1.5 before:animate-pulse before:rounded-full before:ring-2 before:ring-opacity-50",{"before:bg-yellow-500 before:ring-yellow-500":1===e.status,"before:bg-rose-500 before:ring-rose-500":2===e.status,"before:bg-green-500 before:ring-green-500":3===e.status,"before:bg-zinc-500 before:ring-zinc-500":4===e.status}),children:r("status.".concat(e.status))})}),(0,a.jsx)(p.BT,{className:"flex gap-2",children:4!==e.status?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(f.$,{size:"sm",onClick:()=>g(e.id),children:r("reply")},"reply"),(0,a.jsx)(A,{trigger:(0,a.jsx)(f.$,{variant:"destructive",size:"sm",children:r("close")}),title:r("confirmClose"),description:r("closeWarning"),onConfirm:async()=>{var t;await i({id:e.id,status:4}),U.toast.success(r("closeSuccess")),null===(t=I.current)||void 0===t||t.refresh()},cancelText:r("cancel"),confirmText:r("confirm")},"close")]}):(0,a.jsx)(f.$,{size:"sm",onClick:()=>g(e.id),children:r("check")},"check")})]}),(0,a.jsx)(p.Wu,{className:"p-3 text-sm",children:(0,a.jsxs)("ul",{className:"grid gap-3 *:flex *:flex-col lg:grid-cols-3",children:[(0,a.jsxs)("li",{children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:r("title")}),(0,a.jsxs)("span",{children:[" ",e.title]})]}),(0,a.jsxs)("li",{className:"font-semibold",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:r("description")}),(0,a.jsx)("time",{children:e.description})]}),(0,a.jsxs)("li",{className:"font-semibold",children:[(0,a.jsx)("span",{className:"text-muted-foreground",children:r("updatedAt")}),(0,a.jsx)("time",{children:(0,O.Yq)(e.updated_at)})]})]})})]}),empty:(0,a.jsx)(s.Empty,{})}),(0,a.jsx)(b,{open:!!n,onOpenChange:e=>{e||g(null)},children:(0,a.jsxs)(N,{className:"container mx-auto h-screen",children:[(0,a.jsxs)(w,{className:"border-b text-left",children:[(0,a.jsx)(C,{children:null==D?void 0:D.title}),(0,a.jsx)(R,{className:"line-clamp-3",children:null==D?void 0:D.description})]}),(0,a.jsx)(z,{className:"h-full overflow-hidden",ref:S,children:(0,a.jsx)("div",{className:"flex flex-col gap-4 p-4",children:null==D?void 0:null===(t=D.follow)||void 0===t?void 0:t.map(e=>(0,a.jsx)("div",{className:(0,v.cn)("flex items-center gap-4",{"flex-row-reverse":"System"!==e.from}),children:(0,a.jsxs)("div",{className:(0,v.cn)("flex flex-col gap-1",{"items-end":"System"!==e.from}),children:[(0,a.jsx)("p",{className:"text-muted-foreground text-sm",children:(0,O.Yq)(e.created_at)}),(0,a.jsxs)("p",{className:(0,v.cn)("bg-accent w-fit rounded-lg p-2 font-medium",{"bg-primary text-primary-foreground":"System"!==e.from}),children:[1===e.type&&e.content,2===e.type&&(0,a.jsx)(Z(),{src:e.content,width:300,height:300,className:"!size-auto object-cover",alt:"image"})]})]})},e.id))})}),(null==D?void 0:D.status)!==4&&(0,a.jsx)(k,{children:(0,a.jsxs)("form",{className:"flex w-full flex-row items-center gap-2",onSubmit:async e=>{e.preventDefault(),j&&(await c({ticket_id:n,from:"User",type:1,content:j}),E(),y(""))},children:[(0,a.jsxs)(f.$,{type:"button",variant:"outline",className:"p-0",children:[(0,a.jsx)(_.J,{htmlFor:"picture",className:"p-2",children:(0,a.jsx)(L.Icon,{icon:"uil:image-upload",className:"text-2xl"})}),(0,a.jsx)(T.p,{id:"picture",type:"file",className:"hidden",accept:"image/*",onChange:e=>{var t;let r=null===(t=e.target.files)||void 0===t?void 0:t[0];if(r&&r.type.startsWith("image/")){let e=new FileReader;e.readAsDataURL(r),e.onload=e=>{var t;let r=new Image;r.src=null===(t=e.target)||void 0===t?void 0:t.result,r.onload=()=>{let e=document.createElement("canvas"),t=e.getContext("2d"),a=r.width,s=r.height;a>s?a>300&&(s=Math.round(300/a*s),a=300):s>300&&(a=Math.round(300/s*a),s=300),e.width=a,e.height=s,null==t||t.drawImage(r,0,0,a,s),e.toBlob(e=>{let t=new FileReader;t.readAsDataURL(e),t.onloadend=async()=>{await c({ticket_id:n,from:"User",type:2,content:t.result}),E()}},"image/webp",.8)}}}}})]}),(0,a.jsx)(T.p,{placeholder:r("inputPlaceholder"),value:j,onChange:e=>y(e.target.value)}),(0,a.jsx)(f.$,{type:"submit",disabled:!j,children:(0,a.jsx)(L.Icon,{icon:"uil:navigator"})})]})})]})})]})}},61674:(e,t,r)=>{"use strict";r.d(t,{$v:()=>h,EO:()=>m,Lt:()=>d,Rx:()=>g,Zr:()=>v,ck:()=>p,r7:()=>x,tv:()=>o,wd:()=>f});var a=r(54568),s=r(86045),l=r(7620),n=r(26525),i=r(49773);let d=s.bL,o=s.l9,c=s.ZL,u=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,a.jsx)(s.hJ,{className:(0,i.cn)("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/80",r),...l,ref:t})});u.displayName=s.hJ.displayName;let m=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,a.jsxs)(c,{children:[(0,a.jsx)(u,{}),(0,a.jsx)(s.UC,{ref:t,className:(0,i.cn)("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border p-6 shadow-lg duration-200 sm:rounded-lg",r),...l})]})});m.displayName=s.UC.displayName;let f=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",t),...r})};f.displayName="AlertDialogHeader";let p=e=>{let{className:t,...r}=e;return(0,a.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",t),...r})};p.displayName="AlertDialogFooter";let x=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,a.jsx)(s.hE,{ref:t,className:(0,i.cn)("text-lg font-semibold",r),...l})});x.displayName=s.hE.displayName;let h=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,a.jsx)(s.VY,{ref:t,className:(0,i.cn)("text-muted-foreground text-sm",r),...l})});h.displayName=s.VY.displayName;let g=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,a.jsx)(s.rc,{ref:t,className:(0,i.cn)((0,n.r)(),r),...l})});g.displayName=s.rc.displayName;let v=l.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,a.jsx)(s.ZD,{ref:t,className:(0,i.cn)((0,n.r)({variant:"outline"}),"mt-2 sm:mt-0",r),...l})});v.displayName=s.ZD.displayName},26525:(e,t,r)=>{"use strict";r.d(t,{$:()=>o,r:()=>d});var a=r(54568),s=r(67680),l=r(13686),n=r(7620),i=r(49773);let d=(0,l.F)("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-colors focus-visible:outline-none focus-visible:ring-1 focus-visible:ring-ring disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground shadow hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground shadow-sm hover:bg-destructive/90",outline:"border border-input bg-background shadow-sm hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground shadow-sm hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2",sm:"h-8 rounded-md px-3 text-xs",lg:"h-10 rounded-md px-8",icon:"h-9 w-9"}},defaultVariants:{variant:"default",size:"default"}}),o=n.forwardRef((e,t)=>{let{className:r,variant:l,size:n,asChild:o=!1,...c}=e,u=o?s.DX:"button";return(0,a.jsx)(u,{className:(0,i.cn)(d({variant:l,size:n,className:r})),ref:t,...c})});o.displayName="Button"},46359:(e,t,r)=>{"use strict";r.d(t,{BT:()=>o,Wu:()=>c,ZB:()=>d,Zp:()=>n,aR:()=>i,wL:()=>u});var a=r(54568),s=r(7620),l=r(49773);let n=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("bg-card text-card-foreground rounded-xl border shadow",r),...s})});n.displayName="Card";let i=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex flex-col space-y-1.5 p-6",r),...s})});i.displayName="CardHeader";let d=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("font-semibold leading-none tracking-tight",r),...s})});d.displayName="CardTitle";let o=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("text-muted-foreground text-sm",r),...s})});o.displayName="CardDescription";let c=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("p-6 pt-0",r),...s})});c.displayName="CardContent";let u=s.forwardRef((e,t)=>{let{className:r,...s}=e;return(0,a.jsx)("div",{ref:t,className:(0,l.cn)("flex items-center p-6 pt-0",r),...s})});u.displayName="CardFooter"},47019:(e,t,r)=>{"use strict";r.d(t,{p:()=>n});var a=r(54568),s=r(7620),l=r(49773);let n=s.forwardRef((e,t)=>{let{className:r,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:(0,l.cn)("border-input file:text-foreground placeholder:text-muted-foreground focus-visible:ring-ring flex h-9 w-full rounded-md border bg-transparent px-3 py-1 text-base shadow-sm transition-colors file:border-0 file:bg-transparent file:text-sm file:font-medium focus-visible:outline-none focus-visible:ring-1 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",r),ref:t,...n})});n.displayName="Input"},24721:(e,t,r)=>{"use strict";r.d(t,{J:()=>o});var a=r(54568),s=r(41060),l=r(13686),n=r(7620),i=r(49773);let d=(0,l.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),o=n.forwardRef((e,t)=>{let{className:r,...l}=e;return(0,a.jsx)(s.b,{ref:t,className:(0,i.cn)(d(),r),...l})});o.displayName=s.b.displayName},44488:(e,t,r)=>{"use strict";r.d(t,{Icon:()=>l});var a=r(54568),s=r(19463);function l(e){return(0,a.jsx)(s.In,{...e})}},49773:(e,t,r)=>{"use strict";r.d(t,{cn:()=>l});var a=r(75928),s=r(76564);function l(){for(var e=arguments.length,t=Array(e),r=0;r<e;r++)t[r]=arguments[r];return(0,s.QP)((0,a.$)(t))}}},e=>{var t=t=>e(e.s=t);e.O(0,[7503,2249,5627,9463,4999,5215,2468,728,9683,4258,4638,734,2950,930,4690,475,587,2855,7358],()=>t(4141)),_N_E=e.O()}]);